<!DOCTYPE html>
<html>
  <head>
    <title>Bootstrap 101 Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <!--link href="css/bootstrap.css" rel="stylesheet"-->
	<style>
	.content{background:#fff;}
	.workarea{
		height:200px;
		background: url(parts/qup_white.png) no-repeat 10px 50%;
                position:relative;
	}
	.workarea.red{background-image:url(parts/qup_red.png);}
	.workarea.blue{background-image:url(parts/qup_blue.png);}
	.workarea.yellow{background-image:url(parts/qup_yellow.png);}
	.workarea.straddle {background-image:none;}
	#straddle > * {float:left;margin-right:-38px;}
	.workarea.straddle .qup{
		background-image: url("parts/qup_white.png");
		background-size: auto 50px;
		background-repeat: no-repeat;
		height:50px;
		width:290.5px;
	}
	.workarea.straddle.slot1 {background-position-x: 10px,600px, 407px;}
	.workarea.straddle.slot2 {background-position-x: 10px,683px, 483px;}
	.workarea.straddle.slot3 {background-position-x: 10px,836px, 636px;}
	.workarea.straddle.slot4 {background-position-x: 10px,904px, 704px;}
	.workarea.straddle .qup.red {background-image:url(parts/qup_red.png);}
	.workarea.straddle .qup.blue {background-image:url(parts/qup_blue.png);}
	.workarea.straddle .qup.yellow {background-image:url(parts/qup_yellow.png);}
	.workarea.straddle img{height:50px;}
	.tabbable{min-height: 300px;}
	
	.draggable.item span {
		display: block;
	}
	.draggable.item {
		float: left;
		margin: 5px 15px;
	}
	.conct {
		position: absolute;
		top: 50px;
		left: 519px;
	}
	.end	{
		position: absolute;
		top: 50px;
		left: 735px;
	}
	.rod {left:-170px;}
	.straddle .conct{
		top:75px;
	}
	</style>
<div class='content'>
    <h1>Build</h1>
		<div id='single' class='workarea' ondrop="drop_wa(event)" ondragover="allowDrop(event)">
		
		</div>
		<div id='straddle' class='workarea straddle' style="display:none;" ondrop="drop_wa2(event)" ondragover="allowDrop2(event)">
			<div class='qup parts slot1' id='qup1' draggable='false'></div>
			<div id="piecesStraddle">
				<img class='parts slot2' id='prong_rollers' src='parts/prong_rollers.png' draggable='false' />	

			</div>
			
			<div class='qup parts slot3' id='qup2' draggable='false' ></div>
		</div>

		<div class="tabbable tabs-left" ondrop="drop(event)" ondragover="allowDrop(event)">
			<ul class="nav nav-tabs" data-tabs="tabs">
				<li class="active"><a data-toggle="tab" href="#Config">Configuration</a></li>
				<li><a data-toggle="tab" href="#Seal">Sealing Elements</a></li>
				<li id="liCollars"><a data-toggle="tab" href="#Collars">Connectors</a></li>
				<li id="liEnds"><a data-toggle="tab" href="#Ends">Ends</a></li>
				<li id="comboStraddle" style="display:none;"><a data-toggle="tab" href="#combo">Connectors</a></li>

			</ul>
			<div class="tab-content">
				<div id="Config" class="tab-pane active">
					<div class="btn-group" data-toggle="buttons">
					<label class="btn btn-default active">
						<input type="radio" name="inputWalls" id="inputWalls" value="single" onclick='showworkarea("single")' checked>
					Single Bridge Plug </label>
					<label class="btn btn-default">
						<input type="radio" name="inputWalls" id="inputWalls" value="straddle" onclick='showworkarea("straddle")'>
					Straddle System</label>
					</div>
				</div>
				<div id="Seal" class="tab-pane">
					<h4>Sealing Elements</h4>
					<div class='draggable item'>
						<img src='parts/blue.jpg' id='seal_1' draggable="true" ondragstart="drag(event)" />
						<span>HSN</span>
					</div>
					<div class='draggable item'>
						<img src='parts/white.jpg' id='seal_2' draggable="true" ondragstart="drag(event)" />
						<span>Viton</span>
					</div>
					<div class='draggable item'>
						<img src='parts/yellow.jpg' id='seal_3' draggable="true" ondragstart="drag(event)" />
						<span>Aaflas</span>
					</div>
					<div class='draggable item'>
						<img src='parts/red.jpg' id='seal_4' draggable="true" ondragstart="drag(event)" />
						<span>Floro Elastomer</span>
					</div>
				</div>
				<div id="Collars" class="tab-pane">
					<h4>Connectors</h4>
					<div class='draggable item'>
						<img src='parts/kobes_equlisation_housing.png' width="150px" id='conct_kobes' draggable="true" ondragstart="drag(event)" />
						<span>Kobes Equl. Housing</span>
					</div>
					<div class='draggable item'>
						<img src='parts/tandem_coller.png' id='conct_tandem' width="150px" draggable="true" ondragstart="drag(event)" />
						<span>Tandem Coller</span>
					</div>
					<div class='draggable item'>
						<img src='parts/tandem_coller_roller.png' id='conct_tandemr' width="150px" draggable="true" ondragstart="drag(event)" />
						<span>Tandem Roller Coller</span>
					</div>
				</div>
				<div id="Ends" class="tab-pane">
					<h4>Ends</h4>
					<div class='draggable item'>
						<img src='parts/debris_catcher.png' width="150px" id='end_debris' draggable="true" ondragstart="drag(event)" />
						<span>Debris Catcher</span>
					</div>
					<div class='draggable item'>
						<img src='parts/debris_catcher_guagehanger.png' width="150px" id='end_debrisg' draggable="true" ondragstart="drag(event)" />
						<span>Debris Catcher Guage Hanger</span>
					</div>
					<div class='draggable item'>
						<img src='parts/prong_housing.png' width="150px" id='conct_prong' draggable="true" ondragstart="drag(event)" />
						<span>Prong Housing</span>
					</div>
					<div class='draggable item'>
						<img src='parts/pump_through.png' width="150px" id='end_pumpthrough' draggable="true" ondragstart="drag(event)" />
						<span>Pump Through Housing</span>
					</div>
					<div class='draggable item'>
						<img src='parts/choke.png' width="150px" id='end_choke' draggable="true" ondragstart="drag(event)" />
						<span>Choke Housing</span>
					</div>
				</div>
				<div id="combo" class="tab-pane">
					<h4>Connectors</h4>
					<div class='draggable item'>
						<label>Number of pieces</label>
						<select id="numberPieces">
						  <option selected>0</option>
						  <option value="1">1</option>
						  <option value="2">2</option>
						</select>
						<img src='parts/tandem_coller_roller.png' id='conct_tandemr' width="150px" />
						<img src='parts/flow_tube.png' id='ext_flow' width="150px" style='margin-left: -45px;' />
						<span>Tandem Roller Coller + Extension Flow Tube</span>
					</div>
				</div>
			</div>
		</div>
		<div>
			<h1 id="form">Form Order for Single Bridge Plug</h1>
			<label>Seal type</label>
			<input type="text" id="sealSelected" value="Viton" disabled>
			<label class="single">Connector field</label>
			<input class="single" type="text" id="connector" disabled>
			<label class="single">End piece field</label>
			<input class="single" type="text" id="endField" disabled>
			<label class="straddleLabel" style="display:none;">Collar/flowtube count field</label>
			<input type="text" id="CollarFlow" class="straddleLabel" disabled style="display:none;">
			<label>Comments</label>
			<textarea id="comments"></textarea>
			<br>

			<button type="button" id="submit">Submit Order</button>
			
		</div>

</div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <!--script src="scripts/bootstrap.min.js"></script-->
	<script>
		var typeOrder = 1;

		function Part(part,connect,over){
			this.part = part;
			this.connect = connect;
			this.over = over;
		}
		function partdragover(ev){
			//is mouse on the left or right half
			var targetwidth = $(ev.target).width();
			var mrelpos = ev.originalEvent.offsetX;
			if(mrelpos < (targetwidth / 2)){
				$(ev.target).css('padding-left','150px').css('padding-right','');
			}else{
				$(ev.target).css('padding-right','150px').css('padding-left','');
			}
			//console.log('mouse:p:' + ev.originalEvent.pageX + '  o:' + ev.originalEvent.offsetX + '  pos.left ' + $(ev.target).position().left);
			//move to make space (set margin left)
		}
		function partdragleave(ev){
			$(ev.target).css('padding-left','').css('padding-right','');
		}
		
		var dragging = false;

		$(function () {
		//tabs
			$('.nav-tabs a').click(function (e) {
				e.preventDefault();
				$(this).parent().parent().children().removeClass('active');
				$(this).parent().addClass('active');
				$('.tab-content div').removeClass('active');
				$($(this).attr('href')).addClass('active');
			});
		});

		$('#numberPieces').on('change',function(event){
			event.preventDefault();
			addPieces($('#numberPieces').val());
			$('#CollarFlow').val($('#numberPieces').val());

		});

		$('#submit').on('click',function(event){
			event.preventDefault();
			if(typeOrder == 1){ //Order Symple
				if($('#connector').val()=="" || $('#endField').val()=="")
					alert("Incomplete pieces");
				else{
					//make order
					alert("making order");
				}
			}else{ // Order Straddle
				if($('#CollarFlow').val()=="0")
					alert("The number of connectors must be greater than zero");
				else{
					//make order
					alert("making order");
				}
			}
			
		});

		function addPieces(number){
			if(number == 0){
			$('#piecesStraddle').html("<img class='parts slot2' id='prong_rollers' src='parts/prong_rollers.png' draggable='false' />	")
				
			}else{
				var htmlImages = "";
				for(var i=0;i<number;i++){
					if(i==0)
					htmlImages+="<img class='parts slot2' id='prong_rollers' src='parts/tandem_coller_roller.png' draggable='false' />";
					else
						htmlImages+="<img class='parts slot2' id='prong_rollers' src='parts/tandem_coller_roller.png' draggable='false' style='margin-left: -45px;'/>";
					htmlImages+="<img class='parts slot2' id='prong_rollers' src='parts/flow_tube.png' draggable='false' style='margin-left: -45px;' />";
				}
				htmlImages +="<img class='parts slot2' id='prong_rollers' src='parts/prong_rollers.png' draggable='false' style='margin-left: -45px;' />";
				$('#piecesStraddle').html(htmlImages);
			}
		}

		function showworkarea(area){
			if(area=='straddle'){
				typeOrder = 2;
				$('#single').hide();
				$('#liEnds').hide();
				$('#liCollars').hide();
				$('.single').hide();
				$('#comboStraddle').show();
				$('#straddle').show();
				addPieces(0);
				$('#form').text("Form Order for Straddle System");
				$('.straddleLabel').show();
				$('.workarea.straddle .qup').removeClass("red").removeClass("yellow").removeClass("blue");
				$('#sealSelected').val("Viton");
				$('#CollarFlow').val("0");
				$('#comments').val("");
			}else{
				typeOrder = 1;
				$('#single').show();
				$('#liEnds').show();
				$('#liCollars').show();
				$('#straddle').hide();
				$('#comboStraddle').hide();
				$('#form').text("Form Order for Single Bridge Plug");
				$('.straddleLabel').hide();
				$('.single').show();
				$('.workarea').removeClass("red").removeClass("yellow").removeClass("blue");
				$('#sealSelected').val("Viton");
				$('#comments').val("");
			}
		}

		//drag n drop
		function allowDrop(ev){
			ev.preventDefault();
		}
		function allowDrop2(ev){
			ev.preventDefault();
			
		}

		function drag(ev){
			ev.dataTransfer.setData("Text",ev.target.id);
			dragging = true;
		}
		function drop_wa(ev){
			dragging = false;
			ev.preventDefault();
			var data=ev.dataTransfer.getData("Text");

			/* I'm changing the background image in css for the QUP,		
			but adding img dom nodes for the rest */
			
			data = data.split('_');
			switch(data[0]){
				case "seal":
					changeSeal(data[1]);	
					break;
				case "conct":
					$('.conct').remove();
					switch(data[1]){
						case "kobes":
							$('#connector').val("Kobes Equl. Housing");
							$('#single').append(
								$("<img src='parts/kobes_equlisation_housing.png' class='conct' id='wa_conct_kobes' draggable='true' ondragstart='drag(event)' />")
							).append(
								$("<img src='parts/kobes_rod.png' class='end rod' id='wa_rod_kobesrod' draggable='false' />")
							)
							break;
						case "tandem":
						    $('#connector').val("Tamdem Coller");
							$('#single').append(
								$("<img src='parts/tandem_coller.png' class='conct' id='wa_conct_tandem' draggable='true' ondragstart='drag(event)' />")
							);
							break;
						case "tandemr":
						    $('#connector').val("Tamdem Roller Coller");
							$('#single').append(
								$("<img src='parts/tandem_coller_roller.png' class='conct' id='wa_conct_tandemr' draggable='true' ondragstart='drag(event)' />")
							);
							break;
						case "prong":
							$('#connector').val("Prong Housing");
							$('#endField').val("-");
							$('#single').append(
								$("<img src='parts/prong_housing.png' class='conct' id='wa_conct_prong' draggable='true' ondragstart='drag(event)' />")
							);
							$('.end').remove();
							break;
					}
					break;
				case "end":
					$('.end').remove();
					$('#wa_conct_prong').remove();
					if($('#connector').val()=="Prong Housing"){
						$('#connector').val("");
					}
					switch(data[1]){
						case "debris":
						    $('#endField').val("Debris Catcher");
							$('#single').append(
								$("<img src='parts/debris_catcher.png' class='end' id='wa_end_debris' draggable='true' ondragstart='drag(event)' />")
							).append(
								$("<img src='parts/prong_rod.png' class='end rod' id='wa_rod_prongrod' draggable='false' />")
							);
							break;
						case "debrisg":
						    $('#endField').val("Debris Catcher Guage Hanger");
							$('#single').append(
								$("<img src='parts/debris_catcher_guagehanger.png' class='end' id='wa_end_debrisg' draggable='true' ondragstart='drag(event)' />")
							).append(
								$("<img src='parts/prong_rod.png' class='end rod' id='wa_rod_prongrod' draggable='false' />")
							);
							break;
						case "pumpthrough":
						    $('#endField').val("Pump Through Housing");
							$('#single').append(
								$("<img src='parts/pump_through.png' class='end' id='wa_end_pump_through' draggable='true' ondragstart='drag(event)' />")
							);
							break;
						case "choke":
						    $('#endField').val("Choke Housing");
							$('#single').append(
								$("<img src='parts/choke.png' class='end' id='wa_end_choke' draggable='true' ondragstart='drag(event)' />")
							);
							break;
					}
					break;
			}
		}
		function drop_wa2(ev){
			dragging = false;
			ev.preventDefault();
			var data=ev.dataTransfer.getData("Text");
			data = data.split('_');
			switch(data[0]){
				case "seal":
					changeSeal2(data[1]);	
					break;
				
				break;
			}
			
		}
		function drop(ev){
			/* remove stuff from the wa when dragged to the tabs area */
			ev.preventDefault();
			var data=ev.dataTransfer.getData("Text");
			if(data.split('_')[0] == 'wa'){
				$('#'+data).remove();
				$('.rod').remove();
			}
		}
		function changeSeal(color){
		//$('.workarea').removeClass("red").removeClass("yellow").removeClass("blue");
		switch(color) {
			case "1":
			  $('#sealSelected').val("HSN");
			  $('.workarea').removeClass("red").removeClass("yellow").addClass("blue");
			  break;
			case "2":
			  $('#sealSelected').val("Viton");
			  $('.workarea').removeClass("red").removeClass("yellow").removeClass("blue");
			  break;
			case "3":
			  $('#sealSelected').val("Aaflas");
			  $('.workarea').removeClass("red").removeClass("blue").addClass("yellow");
			  break;
			case "4":
			  $('#sealSelected').val("Floro Elastomer");
			  $('.workarea').removeClass("yellow").removeClass("blue").addClass("red");
			  break;
		}
		}

		function changeSeal2(color){
		switch(color) {
			case "1":
			  $('#sealSelected').val("HSN");
			  $('.workarea.straddle .qup').removeClass("red").removeClass("yellow").addClass("blue");
			  break;
			case "2":
			  $('#sealSelected').val("Viton");
			  $('.workarea.straddle .qup').removeClass("red").removeClass("yellow").removeClass("blue");
			  break;
			case "3":
			  $('#sealSelected').val("Aaflas");
			  $('.workarea.straddle .qup').removeClass("red").removeClass("blue").addClass("yellow");
			  break;
			case "4":
			  $('#sealSelected').val("Floro Elastomer");
			  $('.workarea.straddle .qup').removeClass("yellow").removeClass("blue").addClass("red");
			  break;
		}
		}
	</script>
WIDG;
	
  </body>
</html>
